@model Your_Ride.Helper.PaginatedList<Your_Ride.ViewModels.TimeViewModel.TimeVM>

<div class="container mt-4">
    <h2 class="mb-4 text-center">🚌 All Time Appointments</h2>

    <!-- Search Bar -->
    <form asp-action="GetAllTimes" method="get" class="mb-4">
        <div class="input-group">
            <input type="text" name="search" class="form-control" placeholder="🔎 Search by Driver, Plate, Seat, Time, Date">
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </form>

    <!-- Sorting Links -->
    <div class="d-flex justify-content-center mb-3">
        <a asp-action="GetAllTimes" asp-route-sortOrder="@ViewBag.TimeSortParam" class="btn btn-outline-dark me-2">Sort by Time</a>
        <a asp-action="GetAllTimes" asp-route-sortOrder="@ViewBag.DriverSortParam" class="btn btn-outline-dark">Sort by Driver</a>
    </div>

    <!-- Responsive Table -->
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>🕒 Time</th>
                    <th>👤 Bus Guide</th>
                    <th>🚏 Bus Tag</th>
                    <th>👨‍✈️ Driver</th>
                    <th>🚗 Plate</th>
                    <th>💺 Seat Number</th>
                    <th>📅 Appointment Date</th>
                    <th>⚙️ Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var time in Model.Items)
                {
                    <tr>
                        <td>@time.TimeOnly.ToString("hh:mm tt")</td>
                        <td>@time.BusGuide.FirstName @time.BusGuide.LastName</td>
                        <td>@time.Bus.BusIdentifier</td>
                        <td>@time.Bus.DriverName</td>
                        <td>@time.Bus.PlateNumber</td>
                        <td>@time.Bus.NumberOfSeats</td>
                        <td>@time.Appointment.Date.ToShortDateString()</td>
                        <td>
                            <a asp-action="GetTimeByID" asp-route-id="@time.Id" class="btn btn-info btn-sm">View</a>
                            <a asp-action="EditTime" asp-route-id="@time.Id" class="btn btn-warning btn-sm">Edit</a>
                            <a asp-action="DeleteTime" asp-route-id="@time.Id" class="btn btn-danger btn-sm">Delete</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="d-flex justify-content-center mt-4">
        @if (Model.HasPrevious)
        {
            <a asp-action="GetAllTimes" asp-route-page="@(Model.PageNumber - 1)" class="btn btn-outline-primary me-2">⬅️ Previous</a>
        }
        <span class="align-self-center">Page @Model.PageNumber of @Model.TotalPages</span>
        @if (Model.HasNext)
        {
            <a asp-action="GetAllTimes" asp-route-page="@(Model.PageNumber + 1)" class="btn btn-outline-primary ms-2">Next ➡️</a>
        }
    </div>

    <div class="text-center mt-4">
        <a asp-action="CreateTime" class="btn btn-success">➕ Create New Time</a>
    </div>
</div>
