@model Your_Ride.Helper.PaginatedList<Your_Ride.ViewModels.TimeViewModel.TimeVM>
<style>
    th, td {
        text-align: center;
        vertical-align: middle;
    }

        th span {
            display: block;
            font-size: 28px; /* Adjust size if needed */
        }
</style>
<div class="container mt-4">
    <h2 class="mb-4 text-center">🚌 All Time Appointments</h2>

    <!-- Search Bar -->
    <form asp-action="GetAllTimes" method="get" class="mb-4">
        <div class="input-group">
            <input type="text" name="search" class="form-control" placeholder="🔎 Search by Driver, Plate, Seat, Time, Date">
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </form>

    <!-- Sorting Links -->
    <div class="d-flex justify-content-center mb-3">
        <a asp-action="GetAllTimes" asp-route-sortOrder="@ViewBag.TimeSortParam" class="btn btn-outline-dark me-2">Sort by Time</a>
        <a asp-action="GetAllTimes" asp-route-sortOrder="@ViewBag.DriverSortParam" class="btn btn-outline-dark">Sort by Driver</a>
    </div>

    <!-- Responsive Table -->
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th class="text-center"><span>🕒</span><br>Time</th>
                    <th class="text-center"><span>📂</span><br>Category</th>
                    <th class="text-center"><span>👤</span><br>Bus Guide</th>
                    <th class="text-center"><span>🚏</span><br>Bus Tag</th>
                    <th class="text-center"><span>👨‍✈️</span><br>Driver</th>
                    <th class="text-center"><span>🚗</span><br>Plate</th>
                    <th class="text-center"><span>💺</span><br>Seat Number</th>
                    <th class="text-center"><span>📅</span><br>Appointment Date</th>
                    <th class="text-center"><span>✅</span><br>Completed</th>
                    <th class="text-center"><span>⚙️</span><br>Actions</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var time in Model.Items)
                {
                    <tr>
                        <td>@time.TimeOnly.ToString("hh:mm tt")</td>
                        <td>@time.Category</td>
                        <td>@time.BusGuide.FirstName @time.BusGuide.LastName</td>
                        <td>@time.Bus.BusIdentifier</td>
                        <td>@time.Bus.DriverName</td>
                        <td>@time.Bus.PlateNumber</td>
                        <td>@time.Bus.NumberOfSeats</td>
                        <td>@time.Appointment.Date.ToShortDateString()</td>
                        <td>@(time.HasCompleted ? "Yes" : "No")</td>
                        <td>
                            <a asp-action="GetTimeByID" asp-route-id="@time.Id" class="btn btn-info btn-sm">View</a>
                            <a asp-action="EditTime" asp-route-id="@time.Id" class="btn btn-warning btn-sm">Edit</a>
                            <a asp-action="DeleteTime" asp-route-id="@time.Id" class="btn btn-danger btn-sm">Delete</a>
                            @if (time.HasCompleted != true)
                            {
                                <form asp-action="CompleteTime" method="post" style="display:inline;">
                                    <input type="hidden" name="id" value="@time.Id" />
                                    <button type="submit" class="btn btn-warning">Complete</button>
                                </form>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="d-flex justify-content-center mt-4">
        @if (Model.HasPrevious)
        {
            <a asp-action="GetAllTimes" asp-route-page="@(Model.PageNumber - 1)" class="btn btn-outline-primary me-2">⬅️ Previous</a>
        }
        <span class="align-self-center">Page @Model.PageNumber of @Model.TotalPages</span>
        @if (Model.HasNext)
        {
            <a asp-action="GetAllTimes" asp-route-page="@(Model.PageNumber + 1)" class="btn btn-outline-primary ms-2">Next ➡️</a>
        }
    </div>

    <div class="text-center mt-4">
        <a asp-action="CreateTime" class="btn btn-success">➕ Create New Time</a>
    </div>
</div>
